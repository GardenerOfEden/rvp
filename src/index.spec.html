<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Tape Spec Runner</title>
  <script src="vendor/systemjs/dist/system.src.js"></script>
  <script src="vendor/tape/tape-jspm.js"></script>
</head>
<body>

    <script>
      // configure aliases for spec files
      var specs = {
        'test': 'vendor/tape/test.spec.js',
        'blobStore': 'app/backend/modules/blobStore.spec.js',
        'pm25': 'app/backend/modules/pm25.spec.js'
      };
    </script>

    <script>
      System.config({map: specs});
      System.config({
        map: {
          'tape': 'npm:tape@4.6.0.js',
          'tap-browser-color': 'vendor/tap-browser-color/index.js'
        }
      });

      // import app config
      System.import('system-config.js').then(function() {
        // colored browser output for tape
        return System.import('tap-browser-color').then(function(browserColor) {
          browserColor();
        });
      }).then(function() {
        // run spec file given by hash
        var spec = location.search.substr(1);
        if (!spec) {
          console.log('no spec given.');
          return;
        }
        if (!specs[spec]) {
          console.log('spec "' + spec + '" not found.');
          return
        }
        return System.import(spec).catch( console.error.bind(console) );
      }).catch( console.error.bind(console) );
    </script>

</body>
</html>
